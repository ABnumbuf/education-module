--------------------------------------------------------------------------------
                 Электронная цифровая подпись по схеме Эль-Гамаля
--------------------------------------------------------------------------------
                                Проверка подписи
--------------------------------------------------------------------------------
    Теперь, когда вы ознакомились с генерацией ключей и алгоритмом подписи, вам 
нужно знать, как проверить эту подпись.
Чтобы проверить подпись, необходимо
    - сообщение
    - публичный ключ
    - подпись

Алгоритм проверки подписи очень прост.
- вычисляется значение хэш-функции
        h = h(m)
- вычисляем y^r * r^s по модулю p
- вычисляем g^h (mod p)
- сравниваем значения y^r * r^s и g^h (mod p)

    Если подпись корректна, то тождество выполняется.

Действительно,
    y^r * r^s = (g^x)^r * (g^k)^s = g^(xr) * g^(k(k^(-1) * (h - x * r))) =
    = g^(xr) * g^h * g^(-x*r) = g^h (mod p)

    Описанная электронная подпись отвечает всем требованиям, предъявляемым 
к подписи.

    Давайте проверим первое свойство подписи (никто не может подделать подпись,
другими словами, никто, кроме автора подписи, не может подписать сообщение 
своей подписью).
    Действительно, из u = (h - x * r) (mod p - 1) мы видим, что секретный ключ x
используется при формировании подписи.
    Более того, множитель (x * r), используемый при формировании подписи в
u = (h - x * r) (mod p - 1), варьируется от сообщения к сообщению 
(поскольку k выбирается случайным образом, то r является случайным).
    По той же причине автор подписи не сможет отказаться от своей подписи, 
поскольку никто другой не знает x, т.е. выполняется второе свойство подписи.
    Также ясно, что в случае конфликта между автором подписи и получателем 
сообщения они могут обратиться к третьим лицам, чтобы выяснить правду. Судья 
может проверить все вычисления, если ему представят числа x, m и r


